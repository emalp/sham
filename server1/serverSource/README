I have to copyright to this stuff
The copyright of all the server stuff goes to Jose Victor

http://www.codeproject.com/Articles/71302/A-Small-C-Language-TCP-Server-Framework
